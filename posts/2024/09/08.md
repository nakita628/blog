---
date: 2024-09-11
title: HonoX
description: HonoX Start
tags: 
    - HonoX
prev:
    text: Zod Prisma
    link: /posts/2024/09/07
next:
    text: Slidev
    link: /posts/2024/09/09
---

# HonoX

::: code-group
```sh [yarn]
yarn create hono
```
:::

## Directory Structure
```
.
‚îú‚îÄ‚îÄ app
‚îÇ   ‚îú‚îÄ‚îÄ client.ts
‚îÇ   ‚îú‚îÄ‚îÄ global.d.ts
‚îÇ   ‚îú‚îÄ‚îÄ islands
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ counter.tsx
‚îÇ   ‚îú‚îÄ‚îÄ routes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _404.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _error.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ _renderer.tsx
‚îÇ   ‚îî‚îÄ‚îÄ server.ts
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ public
‚îÇ   ‚îî‚îÄ‚îÄ favicon.ico
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ vite.config.ts
‚îî‚îÄ‚îÄ wrangler.toml
```

## wrangler.toml
&emsp;`name`„ÅÆÂÄ§„Çí‰øÆÊ≠£„Åó„Å¶ÂÆüË°å„Åô„Çã„ÄÇ`name = "-"`„Åì„Çå„Åß„ÅØ„ÄÅ‰ª•‰∏ã„ÅÆ„Çà„ÅÜ„Å™„Ç®„É©„Éº„Å´„Å™„Çä„Åæ„Åô„ÄÇ

```
[vite] Internal server error: Processing wrangler.toml configuration:
  - Expected "name" to be of type string, alphanumeric and lowercase with dashes only but got "-".
```

::: code-group
```toml [wrangler.toml]
name = "honox"
...
```
:::

## Start

::: code-group
```sh [yarn]
yarn dev
```
:::

## Accesse Browser
```
http://localhost:5173/
```

![img](img/08/01.png)

## HonoX RPC

## Directory Structure

```
.
‚îú‚îÄ‚îÄ app
‚îÇ   ‚îú‚îÄ‚îÄ client.ts
‚îÇ   ‚îú‚îÄ‚îÄ common
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ zod
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îú‚îÄ‚îÄ global.d.ts
‚îÇ   ‚îú‚îÄ‚îÄ islands
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Post
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ index.tsx
‚îÇ   ‚îú‚îÄ‚îÄ routes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _404.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _error.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ _renderer.tsx
‚îÇ   ‚îî‚îÄ‚îÄ server.ts
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ public
‚îÇ   ‚îî‚îÄ‚îÄ favicon.ico
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ vite.config.ts
‚îî‚îÄ‚îÄ wrangler.toml
```

## Hono API

::: code-group
```ts [app/routes/api/index.ts]
import { Hono } from 'hono'
import { validator } from 'hono/validator'
import { reqSchema } from '../../common/zod'
import { ReqType } from '../../common/types'

const app = new Hono()
  .get('/', async (c) => {
    return c.json({ message: 'HonoXüî•' })
  })
  .post(
    '/posts',
    validator('json', (value: ReqType, c) => {
      const parsed = reqSchema.safeParse(value)
      if (!parsed.success) {
        return c.json({ message: 'Bad Request', error: 'ÔºëÊñáÂ≠ó‰ª•‰∏äÔºëÔºîÔºêÊñáÂ≠ó‰ª•ÂÜÖ„ÅßÂÖ•Âäõ„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ' }, 400)
      }
      return parsed.data
    }),
    (c) => {
      const res = c.req.valid('json')

      return c.json(
        {
          message: 'Created',
          post: res.post,
        },
        201,
      )
    },
  )

export type AddType = typeof app
export default app
```
:::

## FrontEnd

::: code-group
```tsx [app/routes/index.tsx]
import { createRoute } from 'honox/factory'
import Client from '../islands'
import Post from '../islands/Post'

export default createRoute((c) => {
  return c.render(
    <>
      <h1>HonoX</h1>
      <Client />
      <Post />
    </>,
  )
})
```
:::

## Get

::: code-group
```tsx [app/islands/index.tsx]
import { hc } from 'hono/client'
import { useState } from 'hono/jsx'
import { AddType } from '../routes/api'

const client = hc<AddType>('/api')

const Client = () => {
  const [message, setMessage] = useState('')

  const onSubmit = async () => {
    const res = await client.index.$get()
    const data = await res.json()
    setMessage(data.message)
  }

  return (
    <>
      <h1>Get</h1>
      <button onClick={onSubmit}>Get Message</button>
      <h1>{message}</h1>
    </>
  )
}

export default Client
```
:::

## Post

::: code-group
```tsx [app/islands/Post/index.tsx]
import { useState } from 'hono/jsx'
import { hc } from 'hono/client'
import { AddType } from '../../routes/api'
import { reqSchema } from '../../common/zod'
import { ReqType } from '../../common/types'

const client = hc<AddType>('/api/')

const Post = () => {
  const [value, setValue] = useState('')
  const [error, setError] = useState<string | null>(null)
  const [posts, setPosts] = useState<string[]>([])

  const handleChange = (e: Event) => setValue(e.target instanceof HTMLInputElement ? e.target.value : value)

  const valueValidate = (value: string): string | null => {
    const parseValue: ReqType = { post: value }
    const result = reqSchema.safeParse(parseValue)
    if (!result.success) {
      return 'ÔºëÊñáÂ≠ó‰ª•‰∏äÔºëÔºîÔºêÊñáÂ≠ó‰ª•ÂÜÖ„ÅßÂÖ•Âäõ„Åó„Å¶‰∏ã„Åï„ÅÑ„ÄÇ'
    }
    return null
  }

  const handleSubmit = async (e: Event) => {
    e.preventDefault()

    const valueValidateError = valueValidate(value)
    if (valueValidateError) {
      setError(valueValidateError)
      return
    }

    try {
      setError(null)
      const res = await client.posts
        .$post({
          json: { post: value },
        })
        .then((res) => res.json())

      const resMessage = res.post
      setPosts([...posts, resMessage])
      setValue('')
    } catch {
      setError('ÊäïÁ®ø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü')
    }
  }

  return (
    <>
      <h1>Post</h1>
      <form onSubmit={handleSubmit}>
        <input type='text' value={value} onChange={handleChange} />
        <button type='submit'>Submit</button>
      </form>
      {error && <h1>{error}</h1>}
      {posts.map((post, index) => (
        <p key={index}>{post}</p>
      ))}
    </>
  )
}

export default Post
```
:::

## Demo

![demo](gif/01/01.gif)